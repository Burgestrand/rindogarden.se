---
import Layout from '../layouts/Layout.astro';
import H2 from '../components/headings/H2.astro'

import Time from '../components/events/Time.astro'
import Adults from '../components/events/Adults.astro'

import localLogo from '../images/logo/Logo-RG-Rectangle-Neg-RGB.png'
import { Image } from 'astro:assets'

import * as events from '../events'

const upcoming = await events.list()
const title = "Rindögården!"
---

<Layout title={title}>
	<header class="subgrid overflow-x-hidden flex flex-col items-center my-4">
		<Image src={localLogo} alt="Rindögården" class="w-full max-w-[500px]" />
		<p class="text-center px-4 col-[content]">
			Vi är precis i <strong>startgroparna</strong>. Håll utkik, det kommer mer här snart!
		</p>
	</header>

	<main class="col-[content] mb-12">
		<H2 class="mb-4 text-4xl border-b-0 uppercase">På gång</H2>
		<ol class="grid grid-cols-[auto_1fr] grid-flow-row gap-y-4">
			{upcoming.map((event) => (
				<li class="group grid grid-cols-subgrid col-start-1" data-uncertain={event.missingAdults > 0}>
					<a href={event.url} class="grid grid-cols-subgrid col-start-1 bg-white text-shark-950 no-underline">
						<Time event={event} class="inline-flex flex-col px-2 py-1 bg-shark-950 text-white uppercase font-bold items-center justify-center font-days-one">
							<span class="text-3xl ">{event.date.day}</span>
							<span class="text-normal">{events.date.custom(event, ({ date, locale }) => date.toLocaleString(locale, { month: 'short' }).replace(".", ""))}</span>
						</Time>

						<article class="mx-2">
							{event.missingAdults > 0 && (
								<p class="font-bold flex justify-between bg-persian-rose-500 text-white text-sm -mx-2 px-2 py-1">
									<strong>Vi saknar {event.missingAdults} {event.missingAdults > 1 ? "vuxna" : "vuxen"}!</strong>
									<strong class="">Engagera dig</strong>
								</p>
							)}

							<div class="py-2 group-data-[uncertain]:grayscale flex flex-col">
								<header>
									<h1 class="text-xl font-days-one tracking-wider leading-none text-puerto-rico-600">{event.data.title}</h1>
									<Time event={event} class="text-sm">
										{events.date.custom(event, ({ date, locale }) => date.toLocaleString(locale, { weekday: 'long' }))}
										kl. {events.time.tiny(event)}
									</Time>
								</header>
								{event.data.summary && (
									<p class="text-normal mb-1 tracking-tighter">{event.data.summary}</p>
								)}
								<Adults event={event} class="flex-wrap gap-1 text-xs" />
							</div>
						</article>
					</a>
				</li>
			))}
		</ol>
	</main>
</Layout>

<style>
	.text-gradient {
		background-image: var(--accent-gradient);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-size: 400%;
		background-position: 0%;
	}
	.link-card-grid {
		grid-template-columns: repeat(auto-fit, minmax(24ch, 1fr));
	}
</style>
